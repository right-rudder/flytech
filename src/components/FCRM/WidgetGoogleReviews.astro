---
import TextCardDark from "../Cards/TextCardDark.astro";
---

<section class="bg-neutral-900 px-5 lg:px-20 py-5 lg:py-10">
  <div class="max-w-7xl mx-auto py-10">
    <TextCardDark
      content={{
        upperheading: "What Our Students Say",
        title: `Our Students <span class="text-primary-500"> Love Us</span>`,
        description:
          "At FlyTech Pilot Academy, we prioritize creating a supportive and safe learning environment where students thrive. Hereâ€™s what some of our students have to say about their training experiences.",
      }}
      textOrientation="center"
    />
  </div>

  <div class="min-h-20 lg:min-h-[600px] relative" id="reviews-placeholder">
    <div class="absolute inset-0 flex items-center justify-center text-white">
      <span class="animate-pulse">Loading reviews...</span>
    </div>
  </div>

  <div
    class="mt-6 px-2 mx-3 lg:mx-0 flex flex-wrap justify-center align-middle items-center gap-6 z-10 animate-fade-bottom"
  >
    <a
      href="https://search.google.com/local/writereview?placeid=ChIJJZSPiTMFwIcRwINkCHkq7jE"
      target="_blank"
      class="btn-primary w-full md:w-auto hover:scale-110 transition-transform duration-300 ease-in-out"
    >
      <span class="drop-shadow-sm">Write a Review</span>
    </a>
  </div>
</section>

<script type="module">
  let reviewsLoaded = false;

  function loadReviews() {
    if (reviewsLoaded) return;
    reviewsLoaded = true;

    const script = document.createElement("script");
    script.src =
      "https://reputationhub.site/reputation/assets/review-widget.js";
    script.async = true;
    document.body.appendChild(script);

    const placeholder = document.getElementById("reviews-placeholder");
    placeholder.innerHTML = `
      <iframe
        class="lc_reviews_widget"
        src="https://reputationhub.site/reputation/widgets/review_widget/3vFNi9MbXshlpgYHZ34h"
        frameborder="0"
        scrolling="no"
        style="min-width: 100%; width: 100%; height: 600px;"
      ></iframe>
    `;
  }

  function onScrollLoadReviews() {
    if (window.scrollY > 200) {
      loadReviews();
      window.removeEventListener("scroll", onScrollLoadReviews);
    }
  }

  window.addEventListener("scroll", onScrollLoadReviews, { passive: true });
</script>
